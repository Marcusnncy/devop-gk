<% layout('admin/layout') -%>
<% pageTitle = 'Quản lý đơn hàng' %>
<% path = '/admin/orders' %>

<div class="d-flex justify-content-between align-items-center mb-5">
  <h1 class="display-5 fw-bold text-danger">
    <i class="fas fa-shopping-cart"></i> QUẢN LÝ ĐƠN HÀNG
  </h1>
  <div>
    <span class="badge bg-primary fs-5">Tổng: <%= orders.length %> đơn</span>
  </div>
</div>

<% if (!orders || orders.length === 0) { %>
  <div class="text-center py-5">
    <img src="https://cdni.iconscout.com/illustration/premium/thumb/empty-cart-4816530-4009725.png" 
         alt="Chưa có đơn hàng" style="width:320px; opacity:0.8;">
    <h3 class="text-muted mt-4">Chưa có đơn hàng nào</h3>
    <p class="lead text-muted">Khi khách đặt hàng, đơn sẽ hiện ở đây</p>
  </div>
<% } else { %>
  <div class="table-responsive">
    <table class="table table-hover align-middle shadow-sm">
      <thead class="table-dark">
        <tr>
          <th>Mã đơn</th>
          <th>Khách hàng</th>
          <th>SĐT</th>
          <th>Tổng tiền</th>
          <th>Ngày đặt</th>
          <th>Trạng thái</th>
          <th>Hành động</th>
        </tr>
      </thead>
      <tbody>
        <% orders.forEach(order => { %>
          <tr>
            <td><strong>#<%= order._id.toString().slice(-6) %></strong></td>
            <td><%= order.customerName %></td>
            <td><%= order.phone %></td>
            <td class="text-danger fw-bold">
              <%= Number(order.total).toLocaleString('vi-VN') %>đ
            </td>
            <td><%= new Date(order.createdAt).toLocaleDateString('vi-VN') %></td>
            <td>
              <span class="badge <%= order.status === 'completed' ? 'bg-success' : order.status === 'cancelled' ? 'bg-danger' : 'bg-warning' %>">
                <%= order.status === 'pending' ? 'Chờ xử lý' : 
                    order.status === 'completed' ? 'Hoàn thành' : 
                    order.status === 'cancelled' ? 'Đã hủy' : 'Đang giao' %>
              </span>
            </td>
            <td>
              <a href="/admin/orders/<%= order._id %>" class="btn btn-info btn-sm">
                <i class="fas fa-eye"></i> Xem
              </a>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
<% } %>